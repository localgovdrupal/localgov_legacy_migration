langcode: en
status: true
dependencies:
  module:
    - localgov_subsites
id: subsites_overview
migration_group: localgov_subsites
label: 'Subsites - overview'
migration_tags:
  - localgov_content_type
source:
  plugin: d8_entity
  key: migration
  entity_type: node
  bundle: campaign_overview
  include_translations: false
  track_changes: true
process:
  nid: nid
  uuid: uuid
  uid: uid
  langcode: langcode
  status: status
  created: created
  changed: changed
  comment: comment
  title: title
  bhcc_banner:
    plugin: entity_ref_lookup
    migration: media_image
    source: field_banner
  # localgov_subsites_banner:
  #   -
  #     plugin: entity_lookup
  #     entity_type: paragraph
  #     bundle: localgov_banner_secondary
  #     source: "@banner_media"
  #     value_key: localgov_image
  #   -
  #     plugin: callback
  #     callable: _localgov_legacy_migration_callback_debug
  localgov_subsites_theme:
    -
      plugin: static_map
      source: field_select_colorway
      default_value: 'bhcc_burgundy'
      map:
        'magenta': 'bhcc_burgundy'
        'orange': 'bhcc_orange'
        'green': 'bhcc_green'
  localgov_subsites_hide_menu: field_hide_sidebar
  localgov_subsites_content:
    plugin: layout_paragraphs
    source: field_page_builder_advanced
  localgov_subsites_summary: 'body/summary'
  # Embed subsite into a service.
  localgov_services_parent:
    -
      plugin: callback
      callable: _localgov_legacy_migration_callback_null_coalesce_target_id
      source:
        - field_sub_hub
        - field_service
  # Disable pathauto for alias migration.
  # 'path/pathauto':
  #   plugin: default_value
  #   default_value: 0
  # 'path/alias': alias
  path: path
  # Workflow content moderation state.
  # moderation_state: moderation_state
  # Alternative Workflow content moderation state.
  # Uncomment the following (and comment out the above) if the source site did
  # not have workflow / content moderation switched on for this content type
  moderation_state:
    -
      plugin: static_map
      source: status
      default_value: draft
      map:
        '0': draft
        '1': published
destination:
  plugin: 'entity:node'
  default_bundle: localgov_subsites_overview
migration_dependencies:
  required:
    - media_image
    - subsites_overview_banners
  optional:
    - paragraph_box_link
    - paragraph_call_out_box
    - paragraph_contact
    - paragraph_fact_box
    - paragraph_link
    - paragraph_link_and_summary
    - paragraph_quote
    - paragraph_text
    - paragraph_topic_list_builder
    - users
